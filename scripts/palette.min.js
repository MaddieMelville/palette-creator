(function(){var F,A,N,y,v,e,x,b,t,i,O,d,q,n,p,z,m,L,w,f,M,D,C,J,H,o,j,B,E,G,s,K,c,I,l,h,r,k,g,a,u;d="scripts/neuquant.worker.min.js";q="initial";z="waiting";p="loading";n="loaded";v="";N=0;F=1;i=1;x=30;m=1;y=0;A=16;O=8;b=64;L=1;t=5;e=10;u=null;M=null;C=null;w=null;g=null;h=null;k=null;a=v;K=N;r=y;J=function(){B();H();if(K!==N&&r!==y){j(a,true);return I(q)}else{o(a,true);j(a,false);return I(z)}};H=function(){u=document.getElementById("wrapper");M=document.getElementById("frame");C=document.getElementById("image");w=document.getElementById("colors");g=document.getElementById("url");h=document.getElementById("size");return(k=document.getElementById("sizevalue"))};B=function(){a=decodeURIComponent(Query.url||(""+(v)));K=parseInt(decodeURIComponent(Query.sample||(""+(N))));r=parseInt(decodeURIComponent(Query.size||(""+(y))));if(K===N||K<i||K>x){K=F}return r===y||r<O||r>b?(r=y):undefined};o=function(P,Q){g.value=P;h.min=O;h.max=b;h.step=L;h.value=A;if(Q){h.addEventListener("change",function(R){return(k.textContent=R.target.value)},true)}return Utils.fireEvent(h,"change")};j=function(P,Q){var R;R=s(t,e);M.style.cssText=("-webkit-transform: rotate("+(R)+"deg)");if(Q){C.addEventListener("load",function(S){return E(S.target)},true)}return(C.src=P)};s=function(R,P){var Q;Q=Math.floor(Math.random()*2)?1:-1;return Q*(Math.random()*(P-R)+R)};I=function(P){var Q;u.className=P;Q=chrome.i18n.getMessage("msg_"+(P));return(Q!=null)?c(Q):undefined};c=function(P){M.title=P;return(C.alt=P)};E=function(P){var Q;I(p);Q=new Worker(d);Q.onmessage=(function(R){var S;S=R.data;switch(S.type){case"log":return(typeof console!=="undefined"&&console!==null)?console.log(S.message):undefined;case"palette":l(S.palette);return I(n)}});Q.onerror=(function(R){throw new Error(""+(R.message)+" ("+(R.filename)+":"+(R.lineno)+")")});return Q.postMessage({type:"quantize",pixels:D(P),sample:K,colors:r})};D=function(R){var P,Q;P=document.createElement("canvas");P.width=R.naturalWidth;P.height=R.naturalHeight;Q=P.getContext("2d");Q.drawImage(R,0,0);return Q.getImageData(0,0,P.width,P.height).data};l=function(Q){var T,Y,S,X,V,U,R,W,P;X=document.createDocumentFragment();W=Q.length>>2;T=W-1;for(R=0;(0<=T?R<=T:R>=T);(0<=T?R+=1:R-=1)){U=R<<2;P=Q[U];V=Q[U+1];Y=Q[U+2];S=f(P,V,Y);X.appendChild(S)}while(w.hasChildNodes()){w.removeChild(w.firstChild)}return w.appendChild(X)};f=function(S,R,P){var Q;Q=G(S,R,P);return Utils.createElement({tagName:"li",className:"color",childNodes:[{tagName:"div",className:"strip",cssText:("background-color: rgb("+(S)+", "+(R)+", "+(P)+")")},{tagName:"div",className:"info",childNodes:[{tagName:"p",textContent:("RGB: "+(S)+", "+(R)+", "+(P))},{tagName:"p",textContent:("HEX: #"+(Q))}]}]})};G=function(S,R,P){var Q;Q=(S<<16)|(R<<8)|(P);Q=Q.toString(16).toUpperCase();while(Q.length<6){Q=("0"+(Q))}return Q};window.addEventListener("load",J,true)}).call(this);